<html>

<head>
    <title>UI + Redux</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.0/redux.min.js" >
    </script>
</head>

<body>
    <div>
        <h1> Todo List </h1>
        <input id='todo' type='text' placeholder="Add Todo" />
        <button id='todoBtn'>Add</button>
        <ul id='todos'></ul>
    </div>
    <div>
        <h1> Goal List </h1>
        <input id='goal' type='text' placeholder="Add Goal" />
        <button id='goalBtn'>Add</button>
        <ul id='goals'></ul>
    </div>


    <script type="text/javascript">
        //Subreducer
        function todos(state = [], action) {
            if (action.type === 'ADD_TODO') {
                state = state.concat([action.todo])
            }
            else if (action.type === 'REMOVE_TODO') {
                state = state.filter(todo => todo.id !== action.todo.id)
            }
            return state
        }

        //Subreducer
        function goals(state = [], action) {
            if (action.type === 'ADD_GOAL') {
                state = state.concat([action.goal])
            }
            else if (action.type === 'REMOVE_GOAL') {
                state = state.filter(goal => goal.id !== action.goal.id)
            }
            return state
        }

        const store = Redux.createStore(Redux.combineReducers({
            todos, goals
        }))

        store.subscribe(() => {
            const { todos, goals } = store.getState()

            document.getElementById('todos').innerHTML = ''
            document.getElementById('goals').innerHTML = ''

            goals.forEach(goal => addGoalToDOM(goal))
            todos.forEach(addTodoToDOM)
        })

        store.dispatch({
            type: 'ADD_TODO',
            todo: {
                id: 0,
                complete: false,
                name: 'SAMPLE TODO 1'
            }
        })

        store.dispatch({
            type: 'ADD_TODO',
            todo: {
                id: 1,
                complete: false,
                name: 'SAMPLE TODO 2'
            }
        })

        store.dispatch({
            type: 'REMOVE_TODO',
            todo: {
                id: 0
            }
        })

        store.dispatch({
            type: 'ADD_GOAL',
            goal: {
                id: 0,
                complete: false,
                name: 'SAMPLE GOAL 1'
            }
        })

        store.dispatch({
            type: 'ADD_GOAL',
            goal: {
                id: 1,
                complete: false,
                name: 'SAMPLE GOAL 2'
            }
        })

        store.dispatch({
            type: 'REMOVE_GOAL',
            goal: {
                id: 0
            }
        })

        let id = 0
        function addTodo() {
            const input = document.getElementById('todo')
            const name = input.value
            input.value = ''

            store.dispatch({
                type: 'ADD_TODO',
                todo: {
                    id: id++,
                    complete: false,
                    name
                }
            })
        }

        document.getElementById('todoBtn').addEventListener('click', addTodo)

        function addGoal() {
            const input = document.getElementById('goal')
            const name = input.value
            input.value = ''

            store.dispatch({
                type: 'ADD_GOAL',
                goal: {
                    id: id++,
                    complete: false,
                    name
                }
            })
        }

        document.getElementById('goalBtn').addEventListener('click', addGoal)

        function addTodoToDOM(todo) {
            const node = document.createElement('li')
            const text = document.createTextNode(todo.name)

            node.appendChild(text)
            document.getElementById('todos').appendChild(node)
        }

        function addGoalToDOM(goal) {
            const node = document.createElement('li')
            const text = document.createTextNode(goal.name)

            node.appendChild(text)
            document.getElementById('goals').appendChild(node)
        }
    </script>
</body>

</html>